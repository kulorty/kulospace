import{a as V,S as R,t as j}from"./thank-LFFSFqej.js";import{u as W,r as o,g as q,w as A,i as G,o as l,c as n,j as y,b as t,t as c,a as s,F as m,d as b,e as H,h as J,m as O,p as Q,f as X}from"./index-CvLtERLo.js";import{_ as Y}from"./Title-CrBsJz9C.js";const g=u=>(Q("data-v-6044ffbf"),u=u(),X(),u),Z={class:"result"},tt=g(()=>t("h2",null,"搜索结果",-1)),et={style:{"margin-top":"1vw"}},at={class:"resultinfo"},ot={key:0,class:"bookBox"},st={class:"sortType"},lt=["onClick"],nt={class:"bookinfo"},rt={class:"bookCover"},ct=["src"],dt={class:"bookDetial"},it=g(()=>t("div",{class:"option"},[t("button",null,"立即阅读"),t("button",null,"加入书架")],-1)),ut={key:1,class:"empty"},vt=g(()=>t("div",null,"暂未搜索到相关内容",-1)),_t=[vt],ht={class:"every"},pt=g(()=>t("h3",null,"大家都在搜",-1)),gt={class:"everyinfo",style:{display:"flex",margin:".6vw 0",transition:"transform 0.4s"}},ft={class:"left"},kt=["src"],yt={class:"right"},mt={key:0,class:"pagination"},bt={__name:"result",setup(u){let d=W(),v=o(d.Key),C=o([]),f=o(0),w=o(0),I=o(null),N=o(),B=o(!0),S=o(d.currentPage),$=o([]),x=o(!0),D=o(!0),E=o(["默认","总字数","总收藏","用户总点击","更新时间"]),T=o(0),r=o(d.selectedType),_=async()=>{B.value=!0;const e=await V.get(`https://search.zongheng.com/search/book?keyword=${v.value}&sort=${r.value}&pageNo=${S.value}&pageNum=20`);let k=o(e.data.data.datas.list);$.value=e.data.data.recDataList,console.log("检索到的数据",e.data.data.datas.total),w.value=e.data.data.datas.total,e.data.data.datas.total/20!=0?f.value=(Math.floor(e.data.data.datas.total/20)+1)*10:f.value=Math.floor(e.data.data.datas.total/20)*10,console.log("ts",k.value);let p=o([]);k.value.forEach(a=>{let i=a.bookId,z=h(a.name),F=h(a.authorName),K=h(a.description),M=h(a.coverUrl);p.value.push({bookId:i,name:z,author:F,description:K,coverUrl:M})}),C.value=p.value,N.close(),window.scrollTo({top:0,behavior:"smooth"})},L=()=>{N=J.service({target:I.value,text:"Loading...",background:"rgba(255,255,255,0.7)"})},P=e=>{switch(T.value=e,e){case 0:r.value="";break;case 1:r.value="totalWord";break;case 2:r.value="totalRecommend";break;case 3:r.value="totalFavorite";break;case 4:r.value="totalClick";break;case 5:r.value="updateTime";break}console.log(r.value),d.$patch({selectedType:r.value}),_()},h=e=>typeof e=="string"&&/<\/?font[^>]*>/gi.test(e)?e.replace(/<\/?font[^>]*>/gi,""):e,U=e=>{L(),S.value=e,d.$patch({currentPage:e}),_()};return q(()=>{v.value=d.Key,L(),_()}),A(()=>d.Key,e=>{v.value=e,_()}),(e,k)=>{const p=G("el-pagination");return l(),n("div",Z,[y(R,{style:{position:"fixed",top:"0",transition:"all 0.4s"}}),t("div",{ref_key:"load",ref:I,class:"resultContent"},[tt,t("div",et,"共检索到"+c(s(w))+"条和“"+c(s(v))+"”相关的书籍",1),t("div",at,[s(x)?(l(),n("div",ot,[t("div",st,[(l(!0),n(m,null,b(s(E),(a,i)=>(l(),n("div",{onClick:z=>s(P)(i),class:O({active:s(T)==i}),key:i},c(a),11,lt))),128))]),(l(!0),n(m,null,b(s(C),a=>(l(),n("div",{key:a.bookId,class:"bookContent"},[t("div",nt,[t("div",rt,[t("img",{src:`https://static.zongheng.com/upload${a.coverUrl}`,alt:""},null,8,ct)]),t("div",dt,[t("p",null,c(a.name),1),t("p",null,"作者："+c(a.author),1),t("p",null,c(a.description),1)])]),it]))),128))])):(l(),n("div",ut,_t)),t("div",ht,[pt,(l(!0),n(m,null,b(s($),a=>(l(),n("div",null,[t("div",gt,[t("div",ft,[t("img",{src:`https://static.zongheng.com/upload${a.imageUrl}`,alt:""},null,8,kt)]),t("div",yt,[t("div",null,c(a.bookName),1),t("div",null,c(a.authorName),1),t("div",null,c(a.summary),1)])])]))),256))])])],512),s(x)&&s(D)?(l(),n("div",mt,[y(p,{class:"fenye",layout:"prev, pager, next",total:s(f),onCurrentChange:s(U)},null,8,["total","onCurrentChange"])])):H("",!0),y(j,{style:{width:"100%"}})])}}},Nt=Y(bt,[["__scopeId","data-v-6044ffbf"]]);export{Nt as default};
